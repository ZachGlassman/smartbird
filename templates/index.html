{% include "top.html" %} {% if current_user.is_authenticated %}
<div id="root"></div>
{% else %}
<div class="jumbotron">
    <h1>smartbird
        <small>personalized flying</small>
    </h1>
    <a href="/register">
        <button class="btn btn-primary">Register</button>
    </a>
    <a href="/login">
        <button class="btn btn-info">Login</button>
    </a>
</div>
<br>
<br>
<div class="container">
    <div style="height:60%; width:80%; position:absolute;">
        <div id="map"></div>
    </div>
</div>
<!--
<script>
    // from https://bl.ocks.org/mbostock/899711
    // Create the Google Mapâ€¦
    var map = new google.maps.Map(d3.select("#map").node(), {
        zoom: 4,
        center: new google.maps.LatLng(39.8283, -98.5795),
        mapTypeId: google.maps.MapTypeId.TERRAIN
    });
    // Load the station data. When the data comes back, create an overlay.
    d3.json('/random_airports', function (error, data) {
        if (error) throw error;
        data.forEach(function (d) {
            d.name = d.name;
            d.longitude = +d.longitude;
            d.latitude = +d.latitude;
        });
        let new_data = {};
        for (var i = 0; i < data.length; i++) {
            new_data[data[i]['name']] = [data[i]['longitude'], data[i]['latitude']]
        }

        let overlay = new google.maps.OverlayView();
        // Add the container when the overlay is added to the map.
        overlay.onAdd = function () {
            var layer = d3.select(this.getPanes().overlayLayer).append("div")
                .attr("class", "stations");

            // Draw each marker as a separate SVG element.
            // We could use a single SVG, but what size would it have?
            overlay.draw = function () {
                var projection = this.getProjection(),
                    padding = 10;

                var marker = layer.selectAll("svg")
                    .data(d3.entries(new_data))
                    .each(transform) // update existing markers
                    .enter().append("svg")
                    .each(transform)
                    .attr("class", "marker");

                // Add a circle.
                marker.append("circle")
                    .attr("r", 4.5)
                    .attr("cx", padding)
                    .attr("cy", padding);

                // Add a label.
                marker.append("text")
                    .attr("x", padding + 7)
                    .attr("y", padding)
                    .attr("dy", ".31em")
                    .text(function (d) { return d.key; });

                /* layer.selectAll('path')
                     .data(d3.entries(path))
                     .each(transform)
                     .enter().append('path')
                     .each(transform)
                     .attr("class", "line")*/

                function transform(d) {
                    d = new google.maps.LatLng(d.value[1], d.value[0]);
                    d = projection.fromLatLngToDivPixel(d);
                    return d3.select(this)
                        .style("left", (d.x - padding) + "px")
                        .style("top", (d.y - padding) + "px");
                }
            };
        };
        overlay.setMap(map);
    });

    var inter = setInterval(function () {
        updateData();
    }, 2000);

    function updateData() {
        d3.json('/random_airports', function (error, data) {
            console.log(data);
            if (error) throw error;
            data.forEach(function (d) {
                d.name = d.name;
                d.longitude = +d.longitude;
                d.latitude = +d.latitude;
            });
            let new_data = {};
            for (var i = 0; i < data.length; i++) {
                new_data[data[i]['name']] = [data[i]['longitude'], data[i]['latitude']]
            }



            var padding = 10;

            var svg = d3.select("body").transition();

            // Add a circle.
            svg.select(".marker")
                .duration(50)
                .attr("r", 4.5)
                .attr("cx", padding)
                .attr("cy", padding)

            /* layer.selectAll('path')
                 .data(d3.entries(path))
                 .each(transform)
                 .enter().append('path')
                 .each(transform)
                 .attr("class", "line")*/


        });

    }

</script> -->{% endif %} {% include "bottom.html" %}